(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4421:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>$});var s=r(5155),a=r(2115),i=r(8274),n=r(760),l=r(7811),c=r(8503),o=r(7581);let d="gemini-1.5-flash",h=new l.ij("AIzaSyAhpocX6TUZe9_xyHeWUzVqLYqhpgz_wqQ"),x=new c.A({concurrency:1,interval:1e3,intervalCap:5,carryoverConcurrencyCount:!0}),m=new o.q({max:100,ttl:36e5,ttlAutopurge:!0}),u=new Map;async function p(e){return new Promise((t,r)=>{let s=new FileReader;s.onload=()=>t(s.result),s.onerror=r,s.readAsDataURL(e)})}async function g(e,t){var r,s,a;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;try{let a=(r=await p(e),s=e.type,[{inlineData:{data:r.split(",")[1],mimeType:s}}]),i=h.getGenerativeModel({model:d}),n=await i.generateContent({contents:[{role:"user",parts:[{text:t},...a]}]});return await n.response.text()||"No analysis returned from Gemini."}catch(s){let r=null==s||null==(a=s.response)?void 0:a.status;if((429===r||r>=500&&r<600)&&i<=3){let r=1e3*Math.pow(2,i);return console.warn("Rate limited. Retrying in ".concat(r,"ms (attempt ").concat(i,"/").concat(3,")")),await new Promise(e=>setTimeout(e,r)),g(e,t,i+1)}throw s}}async function y(e){let{image:t,prompt:r}=e;if(!t)throw Error("No image provided for analysis");let s=await new Promise(e=>{let s=new FileReader;s.onload=()=>{let a,i=JSON.stringify({content:s.result.substring(0,1e3),prompt:r.substring(0,200),size:t.size,name:t.name,type:t.type,lastModified:t.lastModified});try{a=window.btoa(unescape(encodeURIComponent(i)))}catch(e){a=Array.from(i).reduce((e,t)=>e+t.charCodeAt(0).toString(16),"")}e("gemini:".concat(a))},s.readAsDataURL(t)}),a=m.get(s);if(a)return console.log("Returning cached response for:",s.substring(0,50)+"..."),a;if(u.has(s))return console.log("Request already in progress, returning existing promise"),u.get(s);console.log("Starting new Gemini API request for:",s.substring(0,50)+"...");let i=(async()=>{try{let e=await x.add(()=>g(t,r),{throwOnTimeout:!0});return m.set(s,e),e}finally{u.delete(s)}})();return u.set(s,i),i}async function f(e){let{question:t,selectedText:r,fullContext:s}=e;if(!t.trim())throw Error("No question provided");if(!r.trim())throw Error("No selected text provided");if(!s.trim())throw Error("No context provided");let a="You are an expert trading analyst. A user has selected a specific portion of a trading analysis and wants to ask a question about it.\n\nFULL ANALYSIS CONTEXT:\n".concat(s,'\n\nSELECTED TEXT:\n"').concat(r,'"\n\nUSER QUESTION:\n').concat(t,"\n\nPlease provide a clear, concise answer to the user's question specifically about the selected text, while considering the full context of the analysis. Keep your response focused and practical for trading decisions.\n\nIMPORTANT: \n- Answer directly and concisely\n- Reference the selected text in your response\n- Use the full context to provide comprehensive insights\n- Keep trading terminology clear and accessible\n- If the question is unclear, ask for clarification");try{let e,i=JSON.stringify({question:t,selectedText:r.substring(0,200),fullContext:s.substring(0,500)});try{e="context:".concat(window.btoa(unescape(encodeURIComponent(i))))}catch(t){e="context:".concat(Array.from(i).reduce((e,t)=>e+t.charCodeAt(0).toString(16),""))}let n=m.get(e);if(n)return console.log("Returning cached contextual response"),n;if(u.has(e))return console.log("Contextual request already in progress, returning existing promise"),u.get(e);console.log("Starting new contextual Gemini API request");let l=(async()=>{try{let t=await x.add(async()=>{let e=h.getGenerativeModel({model:d}),t=await e.generateContent({contents:[{role:"user",parts:[{text:a}]}]});return await t.response.text()||"No response from Gemini."},{throwOnTimeout:!0});return m.set(e,t),t}finally{u.delete(e)}})();return u.set(e,l),l}catch(e){throw console.error("Error in contextual analysis:",e),Error("Failed to analyze context: ".concat(e.message||"Unknown error"))}}var j=r(7740);let v=e=>{let{size:t=24,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"11",y:"1",width:"2",height:"3"}),(0,s.jsx)("rect",{x:"11",y:"20",width:"2",height:"3"}),(0,s.jsx)("rect",{x:"1",y:"11",width:"3",height:"2"}),(0,s.jsx)("rect",{x:"20",y:"11",width:"3",height:"2"}),(0,s.jsx)("rect",{x:"4.22",y:"4.22",width:"1.42",height:"1.42"}),(0,s.jsx)("rect",{x:"18.36",y:"4.22",width:"1.42",height:"1.42"}),(0,s.jsx)("rect",{x:"4.22",y:"18.36",width:"1.42",height:"1.42"}),(0,s.jsx)("rect",{x:"18.36",y:"18.36",width:"1.42",height:"1.42"}),(0,s.jsx)("rect",{x:"8",y:"8",width:"8",height:"8"}),(0,s.jsx)("rect",{x:"6",y:"10",width:"2",height:"4"}),(0,s.jsx)("rect",{x:"16",y:"10",width:"2",height:"4"}),(0,s.jsx)("rect",{x:"10",y:"6",width:"4",height:"2"}),(0,s.jsx)("rect",{x:"10",y:"16",width:"4",height:"2"})]})},b=e=>{let{size:t=24,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"6",y:"3",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"4",y:"5",width:"2",height:"14"}),(0,s.jsx)("rect",{x:"6",y:"19",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"8",y:"21",width:"8",height:"2"}),(0,s.jsx)("rect",{x:"16",y:"19",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"18",y:"17",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"20",y:"7",width:"2",height:"10"}),(0,s.jsx)("rect",{x:"18",y:"5",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"16",y:"3",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"8",y:"1",width:"8",height:"2"})]})},w=e=>{let{size:t=24,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"10",y:"2",width:"4",height:"4"}),(0,s.jsx)("rect",{x:"18",y:"6",width:"4",height:"4"}),(0,s.jsx)("rect",{x:"18",y:"14",width:"4",height:"4"}),(0,s.jsx)("rect",{x:"10",y:"18",width:"4",height:"4"}),(0,s.jsx)("rect",{x:"2",y:"14",width:"4",height:"4"}),(0,s.jsx)("rect",{x:"2",y:"6",width:"4",height:"4"}),(0,s.jsx)("rect",{x:"8",y:"8",width:"8",height:"8"}),(0,s.jsx)("rect",{x:"10",y:"10",width:"4",height:"4"})]})},N=e=>{let{size:t=64,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 64 64",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"8",y:"20",width:"48",height:"32",fill:"none",stroke:a,strokeWidth:"3"}),(0,s.jsx)("rect",{x:"28",y:"12",width:"8",height:"16"}),(0,s.jsx)("rect",{x:"20",y:"16",width:"8",height:"4"}),(0,s.jsx)("rect",{x:"36",y:"16",width:"8",height:"4"}),(0,s.jsx)("rect",{x:"24",y:"28",width:"4",height:"16"}),(0,s.jsx)("rect",{x:"36",y:"28",width:"4",height:"16"}),(0,s.jsx)("rect",{x:"20",y:"32",width:"12",height:"4"}),(0,s.jsx)("rect",{x:"32",y:"32",width:"12",height:"4"})]})},C=e=>{let{size:t=48,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 48 48",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"6",y:"16",width:"36",height:"24",fill:"none",stroke:a,strokeWidth:"3"}),(0,s.jsx)("rect",{x:"18",y:"22",width:"3",height:"12"}),(0,s.jsx)("rect",{x:"27",y:"22",width:"3",height:"12"}),(0,s.jsx)("rect",{x:"15",y:"25",width:"9",height:"3"}),(0,s.jsx)("rect",{x:"24",y:"25",width:"9",height:"3"}),(0,s.jsx)("rect",{x:"21",y:"10",width:"6",height:"12"}),(0,s.jsx)("rect",{x:"15",y:"13",width:"6",height:"3"}),(0,s.jsx)("rect",{x:"27",y:"13",width:"6",height:"3"})]})},S=e=>{let{size:t=24,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"2",y:"18",width:"4",height:"4"}),(0,s.jsx)("rect",{x:"6",y:"14",width:"4",height:"8"}),(0,s.jsx)("rect",{x:"10",y:"10",width:"4",height:"12"}),(0,s.jsx)("rect",{x:"14",y:"6",width:"4",height:"16"}),(0,s.jsx)("rect",{x:"18",y:"2",width:"4",height:"20"})]})},k=e=>{let{size:t=24,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"4",y:"2",width:"16",height:"20",fill:"none",stroke:a,strokeWidth:"2"}),(0,s.jsx)("rect",{x:"6",y:"6",width:"12",height:"2"}),(0,s.jsx)("rect",{x:"6",y:"10",width:"12",height:"2"}),(0,s.jsx)("rect",{x:"6",y:"14",width:"8",height:"2"}),(0,s.jsx)("rect",{x:"6",y:"18",width:"10",height:"2"})]})},T=e=>{let{size:t=24,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"3",y:"6",width:"18",height:"2"}),(0,s.jsx)("rect",{x:"3",y:"11",width:"18",height:"2"}),(0,s.jsx)("rect",{x:"3",y:"16",width:"18",height:"2"})]})},A=e=>{let{size:t=16,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 16 16",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"2",y:"7",width:"12",height:"2"}),(0,s.jsx)("rect",{x:"7",y:"2",width:"2",height:"12"})]})},P=e=>{let{size:t=16,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 16 16",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"1",y:"3",width:"14",height:"10",fill:"none",stroke:a,strokeWidth:"1"}),(0,s.jsx)("rect",{x:"3",y:"9",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"6",y:"7",width:"2",height:"4"}),(0,s.jsx)("rect",{x:"9",y:"5",width:"2",height:"6"}),(0,s.jsx)("rect",{x:"12",y:"8",width:"2",height:"3"})]})},z=e=>{let{size:t=16,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 16 16",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"2",y:"2",width:"12",height:"12",fill:"none",stroke:a,strokeWidth:"1"}),(0,s.jsx)("rect",{x:"4",y:"5",width:"8",height:"1"}),(0,s.jsx)("rect",{x:"4",y:"7",width:"8",height:"1"}),(0,s.jsx)("rect",{x:"4",y:"9",width:"6",height:"1"}),(0,s.jsx)("rect",{x:"4",y:"11",width:"7",height:"1"})]})},E=e=>{let{size:t=16,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 16 16",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"6",y:"2",width:"4",height:"2"}),(0,s.jsx)("rect",{x:"12",y:"4",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"12",y:"10",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"6",y:"12",width:"4",height:"2"}),(0,s.jsx)("rect",{x:"2",y:"10",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"2",y:"4",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"5",y:"5",width:"6",height:"6"}),(0,s.jsx)("rect",{x:"7",y:"7",width:"2",height:"2"})]})},R=e=>{let{size:t=64,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 64 64",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"8",y:"16",width:"48",height:"32",fill:"none",stroke:a,strokeWidth:"3"}),(0,s.jsx)("rect",{x:"20",y:"24",width:"8",height:"4"}),(0,s.jsx)("rect",{x:"36",y:"24",width:"8",height:"4"}),(0,s.jsx)("rect",{x:"24",y:"36",width:"16",height:"4"})]})},I=e=>{let{size:t=64,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 64 64",fill:a,className:"".concat(r," pixel-loader"),children:[(0,s.jsx)("rect",{x:"28",y:"4",width:"8",height:"8"}),(0,s.jsx)("rect",{x:"44",y:"12",width:"8",height:"8"}),(0,s.jsx)("rect",{x:"52",y:"28",width:"8",height:"8"}),(0,s.jsx)("rect",{x:"44",y:"44",width:"8",height:"8"}),(0,s.jsx)("rect",{x:"28",y:"52",width:"8",height:"8"}),(0,s.jsx)("rect",{x:"12",y:"44",width:"8",height:"8"}),(0,s.jsx)("rect",{x:"4",y:"28",width:"8",height:"8"}),(0,s.jsx)("rect",{x:"12",y:"12",width:"8",height:"8"})]})},B=e=>{let{size:t=24,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"2",y:"4",width:"20",height:"16",fill:"none",stroke:a,strokeWidth:"2"}),(0,s.jsx)("rect",{x:"11",y:"8",width:"2",height:"6"}),(0,s.jsx)("rect",{x:"11",y:"16",width:"2",height:"2"})]})},D=e=>{let{size:t=24,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"6",y:"4",width:"12",height:"16",fill:"none",stroke:a,strokeWidth:"2"}),(0,s.jsx)("rect",{x:"8",y:"8",width:"8",height:"2"}),(0,s.jsx)("rect",{x:"8",y:"12",width:"6",height:"2"}),(0,s.jsx)("rect",{x:"8",y:"16",width:"8",height:"2"}),(0,s.jsx)("rect",{x:"10",y:"2",width:"4",height:"2"})]})},M=e=>{let{size:t=24,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"2",y:"11",width:"20",height:"2"}),(0,s.jsx)("rect",{x:"11",y:"2",width:"2",height:"20"}),(0,s.jsx)("rect",{x:"8",y:"8",width:"8",height:"8",fill:"none",stroke:a,strokeWidth:"2"}),(0,s.jsx)("rect",{x:"10",y:"10",width:"4",height:"4"})]})},U=e=>{let{size:t=24,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"8",y:"2",width:"8",height:"2"}),(0,s.jsx)("rect",{x:"6",y:"4",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"16",y:"4",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"4",y:"6",width:"2",height:"4"}),(0,s.jsx)("rect",{x:"18",y:"6",width:"2",height:"4"}),(0,s.jsx)("rect",{x:"6",y:"10",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"16",y:"10",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"8",y:"12",width:"8",height:"2"}),(0,s.jsx)("rect",{x:"10",y:"14",width:"4",height:"2"}),(0,s.jsx)("rect",{x:"10",y:"18",width:"4",height:"2"})]})},F=e=>{let{size:t=24,className:r="",color:a="currentColor"}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:a,className:r,children:[(0,s.jsx)("rect",{x:"2",y:"10",width:"2",height:"4"}),(0,s.jsx)("rect",{x:"4",y:"8",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"4",y:"14",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"6",y:"6",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"6",y:"16",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"8",y:"4",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"8",y:"18",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"10",y:"2",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"10",y:"20",width:"2",height:"2"}),(0,s.jsx)("rect",{x:"12",y:"2",width:"10",height:"2"}),(0,s.jsx)("rect",{x:"20",y:"4",width:"2",height:"16"}),(0,s.jsx)("rect",{x:"12",y:"20",width:"10",height:"2"})]})},O=()=>{let{theme:e,toggleTheme:t}=(0,j.D)();return(0,s.jsxs)("header",{className:"h-16 bg-[var(--bg-secondary)] border-b-2 border-[var(--border-primary)] flex items-center justify-between px-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-[var(--accent-blue)] border-2 border-[var(--text-primary)] flex items-center justify-center",children:(0,s.jsx)(S,{size:20,color:"var(--text-primary)"})}),(0,s.jsx)("h1",{className:"text-xl font-bold text-[var(--text-primary)] font-mono uppercase tracking-wider",children:"Trading Guide v2"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("button",{onClick:t,className:"pixel-btn w-12 h-12 p-0 flex items-center justify-center transition-all duration-200 hover:scale-105","aria-label":"Switch to ".concat("dark"===e?"light":"dark"," theme"),children:"dark"===e?(0,s.jsx)(v,{size:20}):(0,s.jsx)(b,{size:20})}),(0,s.jsx)("button",{className:"pixel-btn w-12 h-12 p-0 flex items-center justify-center transition-all duration-200 hover:scale-105","aria-label":"Settings",children:(0,s.jsx)(w,{size:20})})]})]})},H=e=>{let{isOpen:t,onToggle:r,uploadedImages:a,progress:i,currentStep:n,onClearImages:l}=e;return(0,s.jsxs)(s.Fragment,{children:[t&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:r}),(0,s.jsxs)("aside",{className:"\n        fixed lg:static inset-y-0 left-0 z-50 w-80 bg-[var(--bg-secondary)] \n        border-r-2 border-[var(--border-primary)] transform transition-transform duration-200 ease-in-out\n        ".concat(t?"translate-x-0":"-translate-x-full lg:translate-x-0","\n        flex flex-col\n      "),children:[(0,s.jsxs)("div",{className:"p-4 border-b-2 border-[var(--border-primary)] flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-lg font-bold text-[var(--text-primary)] font-mono uppercase",children:"Analysis Panel"}),(0,s.jsx)("button",{onClick:r,className:"lg:hidden pixel-btn w-8 h-8 p-0 flex items-center justify-center","aria-label":"Close sidebar",children:(0,s.jsx)(A,{size:16})})]}),(0,s.jsxs)("div",{className:"p-4 border-b-2 border-[var(--border-primary)]",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-[var(--text-secondary)] font-mono uppercase mb-3",children:"Chart Upload"}),a.length>0&&(0,s.jsxs)("div",{className:"space-y-2 mb-4",children:[a.map((e,t)=>(0,s.jsxs)("div",{className:"pixel-card p-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-xs text-[var(--text-primary)] font-mono truncate",children:e.file.name}),(0,s.jsx)("div",{className:"w-3 h-3 ".concat(e.detectedTimeframe?"bg-[var(--accent-green)]":"bg-[var(--accent-yellow)]")})]}),e.detectedTimeframe&&(0,s.jsx)("div",{className:"text-xs text-[var(--accent-blue)] font-mono mt-1",children:e.detectedTimeframe.replace("chart","").toUpperCase()})]},t)),(0,s.jsx)("button",{onClick:l,className:"pixel-btn pixel-btn-danger w-full text-xs",children:"Clear All"})]})]}),(i>0||n)&&(0,s.jsxs)("div",{className:"p-4 border-b-2 border-[var(--border-primary)]",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-[var(--text-secondary)] font-mono uppercase mb-3",children:"Analysis Progress"}),(0,s.jsx)("div",{className:"pixel-progress mb-3",children:(0,s.jsx)("div",{className:"pixel-progress-fill",style:{width:"".concat(i,"%")}})}),n&&(0,s.jsxs)("div",{className:"text-xs text-[var(--accent-blue)] font-mono",children:["Current: ",n.toUpperCase()]})]}),(0,s.jsxs)("div",{className:"p-4 border-b-2 border-[var(--border-primary)]",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-[var(--text-secondary)] font-mono uppercase mb-3",children:"Quick Actions"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("button",{className:"pixel-btn w-full text-xs flex items-center justify-center space-x-2",children:[(0,s.jsx)(P,{size:14}),(0,s.jsx)("span",{children:"Sample Charts"})]}),(0,s.jsxs)("button",{className:"pixel-btn w-full text-xs flex items-center justify-center space-x-2",children:[(0,s.jsx)(z,{size:14}),(0,s.jsx)("span",{children:"User Guide"})]}),(0,s.jsxs)("button",{className:"pixel-btn w-full text-xs flex items-center justify-center space-x-2",children:[(0,s.jsx)(E,{size:14}),(0,s.jsx)("span",{children:"API Settings"})]})]})]}),(0,s.jsxs)("div",{className:"p-4 flex-1 overflow-y-auto",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-[var(--text-secondary)] font-mono uppercase mb-3",children:"Recent Analysis"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"pixel-card p-2 cursor-pointer hover:bg-[var(--bg-tertiary)]",children:[(0,s.jsx)("div",{className:"text-xs text-[var(--text-primary)] font-mono",children:"BTC/USD Analysis"}),(0,s.jsx)("div",{className:"text-xs text-[var(--text-muted)] font-mono",children:"2 hours ago"})]}),(0,s.jsxs)("div",{className:"pixel-card p-2 cursor-pointer hover:bg-[var(--bg-tertiary)]",children:[(0,s.jsx)("div",{className:"text-xs text-[var(--text-primary)] font-mono",children:"ETH/USD Analysis"}),(0,s.jsx)("div",{className:"text-xs text-[var(--text-muted)] font-mono",children:"1 day ago"})]})]})]}),(0,s.jsx)("div",{className:"p-4 border-t-2 border-[var(--border-primary)]",children:(0,s.jsx)("div",{className:"text-xs text-[var(--text-muted)] font-mono text-center",children:"Trading Guide v2.0"})})]})]})},L=e=>{let{onFilesSelected:t,uploadedImages:r,isAnalyzing:i}=e,n=(0,a.useRef)(null),[l,c]=(0,a.useState)(!1);return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"pixel-upload-zone ".concat(l?"dragover":""," ").concat(i?"opacity-50 cursor-not-allowed":""),onDragOver:e=>{e.preventDefault(),c(!0)},onDragLeave:e=>{e.preventDefault(),c(!1)},onDrop:e=>{e.preventDefault(),c(!1);let r=Array.from(e.dataTransfer.files).filter(e=>e.type.startsWith("image/"));r.length>0&&t(r)},onClick:()=>{if(!i){var e;null==(e=n.current)||e.click()}},children:[(0,s.jsx)("input",{ref:n,type:"file",multiple:!0,accept:"image/*",onChange:e=>{e.target.files&&t(Array.from(e.target.files))},className:"hidden",disabled:i}),0===r.length?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)(N,{size:64,color:"var(--accent-blue)"})}),(0,s.jsx)("h3",{className:"text-lg font-bold text-[var(--text-primary)] font-mono uppercase mb-2",children:"Upload Trading Charts"}),(0,s.jsx)("p",{className:"text-[var(--text-secondary)] font-mono text-sm mb-4",children:"Drag & drop your chart images here or click to browse"}),(0,s.jsx)("p",{className:"text-[var(--text-muted)] font-mono text-xs",children:"Supported: 4H, 1H, 15M, 5M timeframes • PNG, JPG, WEBP"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)(C,{size:48,color:"var(--accent-green)"})}),(0,s.jsxs)("h3",{className:"text-lg font-bold text-[var(--accent-green)] font-mono uppercase mb-2",children:[r.length," Chart",r.length>1?"s":""," Uploaded"]}),(0,s.jsx)("p",{className:"text-[var(--text-secondary)] font-mono text-sm",children:"Click to add more charts or proceed with analysis"})]})]}),r.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map((e,t)=>(0,s.jsxs)("div",{className:"pixel-card pixel-card-accent",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h4",{className:"text-sm font-bold text-[var(--text-primary)] font-mono truncate",children:e.file.name}),(0,s.jsxs)("p",{className:"text-xs text-[var(--text-muted)] font-mono",children:[(e.file.size/1024/1024).toFixed(2)," MB"]})]}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:e.detectedTimeframe?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-[var(--accent-green)]"}),(0,s.jsx)("span",{className:"text-xs text-[var(--accent-green)] font-mono font-bold",children:e.detectedTimeframe.replace("chart","").toUpperCase()})]}):e.error?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-[var(--accent-red)]"}),(0,s.jsx)("span",{className:"text-xs text-[var(--accent-red)] font-mono",children:"ERROR"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-[var(--accent-yellow)]"}),(0,s.jsx)("span",{className:"text-xs text-[var(--accent-yellow)] font-mono",children:"DETECTING..."})]})})]}),e.error&&(0,s.jsx)("div",{className:"text-xs text-[var(--accent-red)] font-mono mt-2 p-2 bg-[var(--bg-tertiary)] border border-[var(--accent-red)]",children:e.error})]},t))}),(0,s.jsxs)("div",{className:"pixel-card",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(z,{size:16,color:"var(--accent-blue)"}),(0,s.jsx)("h4",{className:"text-sm font-bold text-[var(--text-primary)] font-mono uppercase",children:"Upload Guidelines"})]}),(0,s.jsxs)("ul",{className:"text-xs text-[var(--text-secondary)] font-mono space-y-1",children:[(0,s.jsx)("li",{children:"• Upload charts for different timeframes (4H, 1H, 15M, 5M)"}),(0,s.jsx)("li",{children:"• Ensure charts are clear and readable"}),(0,s.jsx)("li",{children:"• Include price action and volume indicators"}),(0,s.jsx)("li",{children:"• Maximum 4 charts per analysis session"})]})]})]})};var Q=r(8240),W=r(4823);let q=(0,a.createContext)(void 0),G=()=>{let e=(0,a.useContext)(q);if(!e)throw Error("useTextSelection must be used within a TextSelectionProvider");return e},V=e=>{let{children:t}=e,[r,i]=(0,a.useState)({selectedText:"",fullContext:"",showQueryBar:!1,showChatSidebar:!1,initialQuestion:""});return(0,s.jsx)(q.Provider,{value:{state:r,setSelectedText:(e,t)=>{i(r=>({...r,selectedText:e,fullContext:t}))},showQueryBar:()=>{i(e=>({...e,showQueryBar:!0}))},hideQueryBar:()=>{i(e=>({...e,showQueryBar:!1}))},showChatSidebar:e=>{i(t=>({...t,showQueryBar:!1,showChatSidebar:!0,initialQuestion:e}))},hideChatSidebar:()=>{i(e=>({...e,showChatSidebar:!1,initialQuestion:""}))},clearSelection:()=>{i({selectedText:"",fullContext:"",showQueryBar:!1,showChatSidebar:!1,initialQuestion:""});let e=window.getSelection();e&&e.removeAllRanges()}},children:t})};function Y(e){let{children:t,fullContext:r,className:i=""}=e,{state:n,setSelectedText:l,showQueryBar:c,hideQueryBar:o,clearSelection:d}=G(),h=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e,t=()=>{e&&clearTimeout(e),e=setTimeout(()=>{let e=window.getSelection();if(!e||0===e.rangeCount)return;let t=e.toString().trim();if(!t){n.showQueryBar||(o(),d());return}let s=e.getRangeAt(0),a=h.current;a&&a.contains(s.commonAncestorContainer)&&t!==n.selectedText&&(l(t,r),c())},100)},s=e=>{let t=e.target;t.closest(".bottom-query-bar")||t.closest(".chat-sidebar")||setTimeout(()=>{let e=window.getSelection();e&&""!==e.toString().trim()||(o(),d())},50)};return document.addEventListener("mouseup",t),document.addEventListener("selectionchange",t),document.addEventListener("click",s),()=>{e&&clearTimeout(e),document.removeEventListener("mouseup",t),document.removeEventListener("selectionchange",t),document.removeEventListener("click",s)}},[n.selectedText,n.showQueryBar,r,l,c,o,d]),(0,s.jsx)("div",{ref:h,className:"selectable-content ".concat(i),style:{userSelect:"text",WebkitUserSelect:"text",MozUserSelect:"text",msUserSelect:"text"},children:t})}let _={table:e=>{let{node:t,...r}=e;return(0,s.jsx)("div",{className:"overflow-x-auto mb-4",children:(0,s.jsx)("table",{className:"min-w-full pixel-card",...r})})},thead:e=>{let{node:t,...r}=e;return(0,s.jsx)("thead",{className:"bg-[var(--bg-tertiary)]",...r,children:r.children})},th:e=>{let{node:t,isHeader:r,...a}=e;return(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-bold text-[var(--text-primary)] font-mono uppercase border-b-2 border-[var(--border-primary)]",...a,children:a.children})},tbody:e=>{let{node:t,...r}=e;return(0,s.jsx)("tbody",{className:"bg-[var(--bg-secondary)]",...r,children:r.children})},tr:e=>{let{node:t,...r}=e;return(0,s.jsx)("tr",{className:"border-b border-[var(--border-primary)] hover:bg-[var(--bg-tertiary)]",...r,children:r.children})},td:e=>{let{node:t,...r}=e;return(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-[var(--text-primary)] font-mono",...r,children:r.children})},h1:e=>{let{node:t,...r}=e;return(0,s.jsx)("h1",{className:"text-2xl font-bold text-[var(--accent-blue)] font-mono uppercase mb-4 border-b-2 border-[var(--accent-blue)] pb-2",...r})},h2:e=>{let{node:t,...r}=e;return(0,s.jsx)("h2",{className:"text-xl font-bold text-[var(--accent-blue)] font-mono uppercase mb-3 border-b border-[var(--accent-blue)] pb-1",...r})},h3:e=>{let{node:t,...r}=e;return(0,s.jsx)("h3",{className:"text-lg font-bold text-[var(--text-primary)] font-mono uppercase mb-2",...r})},p:e=>{let{node:t,...r}=e;return(0,s.jsx)("p",{className:"text-[var(--text-primary)] font-mono mb-3 leading-relaxed",...r})},ul:e=>{let{node:t,...r}=e;return(0,s.jsx)("ul",{className:"list-none space-y-1 mb-3",...r})},li:e=>{let{node:t,...r}=e;return(0,s.jsxs)("li",{className:"text-[var(--text-primary)] font-mono flex items-start",...r,children:[(0,s.jsx)("span",{className:"text-[var(--accent-blue)] mr-2",children:"▶"}),(0,s.jsx)("span",{children:r.children})]})},strong:e=>{let{node:t,...r}=e;return(0,s.jsx)("strong",{className:"text-[var(--accent-yellow)] font-bold",...r})},em:e=>{let{node:t,...r}=e;return(0,s.jsx)("em",{className:"text-[var(--accent-green)] font-mono",...r})},code:e=>{let{node:t,inline:r,...a}=e;return r?(0,s.jsx)("code",{className:"bg-[var(--bg-tertiary)] text-[var(--accent-blue)] px-1 py-0.5 font-mono text-sm border border-[var(--border-primary)]",...a}):(0,s.jsx)("code",{className:"block bg-[var(--bg-tertiary)] text-[var(--text-primary)] p-3 font-mono text-sm border-2 border-[var(--border-primary)] overflow-x-auto",...a})}},K=e=>{let{results:t,loading:r,error:i,currentStep:n}=e,[l,c]=(0,a.useState)("overall"),o=[{id:"overall",label:"Overall",hasContent:!!t.finalSuggestion},{id:"4h",label:"4H",hasContent:!!t.analysis4h},{id:"1h",label:"1H",hasContent:!!t.analysis1h},{id:"15min",label:"15M",hasContent:!!t.analysis15m},{id:"5min",label:"5M",hasContent:!!t.analysis5m}];return i?(0,s.jsxs)("div",{className:"pixel-card pixel-card-danger",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,s.jsx)(B,{size:20,color:"var(--accent-red)"}),(0,s.jsx)("h3",{className:"text-lg font-bold text-[var(--accent-red)] font-mono uppercase",children:"Analysis Error"})]}),(0,s.jsx)("p",{className:"text-[var(--text-primary)] font-mono",children:i})]}):r?(0,s.jsxs)("div",{className:"pixel-card text-center py-12",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)(I,{size:64,color:"var(--accent-blue)"})}),(0,s.jsx)("h3",{className:"text-lg font-bold text-[var(--accent-blue)] font-mono uppercase mb-2",children:"Analyzing Charts..."}),n&&(0,s.jsxs)("p",{className:"text-[var(--text-secondary)] font-mono",children:["Current Step: ",n.toUpperCase()]}),(0,s.jsx)("p",{className:"text-xs text-[var(--text-muted)] font-mono mt-2",children:"This may take a moment"})]}):Object.values(t).some(e=>!!e)?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"pixel-tabs",children:o.map(e=>(0,s.jsxs)("button",{onClick:()=>c(e.id),className:"pixel-tab ".concat(l===e.id?"active":""," ").concat(e.hasContent?"":"opacity-50 cursor-not-allowed"),disabled:!e.hasContent,children:[e.label,e.hasContent&&(0,s.jsx)("span",{className:"ml-2 w-2 h-2 bg-[var(--accent-green)] inline-block"})]},e.id))}),(0,s.jsxs)("div",{className:"min-h-[400px]",children:["overall"===l&&t.finalSuggestion&&(0,s.jsx)("div",{className:"space-y-4",children:(()=>{let e=(e=>{let t={summary:"",reasoning:"",positionDetails:""},r=e.match(/(## Reasoning|##\s*Reasoning|\*\*Reasoning)/i);if(r){t.summary=e.substring(0,r.index).trim();let s=r.index+r[0].length,a=e.match(/(## Position Details|##\s*Position Details|\*\*Position Details)/i);a?(t.reasoning=e.substring(s,a.index).trim(),t.positionDetails=e.substring(a.index+a[0].length).trim()):t.reasoning=e.substring(s).trim()}else t.summary=e;return t})(t.finalSuggestion);return(0,s.jsxs)(s.Fragment,{children:[e.summary&&(0,s.jsxs)("div",{className:"pixel-card pixel-card-accent",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,s.jsx)(S,{size:20,color:"var(--accent-blue)"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-[var(--accent-blue)] font-mono uppercase",children:"Trading Summary"})]}),(0,s.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,s.jsx)(Y,{fullContext:t.finalSuggestion||"",children:(0,s.jsx)(Q.oz,{remarkPlugins:[W.A],components:_,children:e.summary})})})]}),e.reasoning&&(0,s.jsxs)("div",{className:"pixel-card",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,s.jsx)(D,{size:20,color:"var(--accent-yellow)"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-[var(--accent-yellow)] font-mono uppercase",children:"Analysis Reasoning"})]}),(0,s.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,s.jsx)(Y,{fullContext:t.finalSuggestion||"",children:(0,s.jsx)(Q.oz,{remarkPlugins:[W.A],components:_,children:e.reasoning})})})]}),e.positionDetails&&(0,s.jsxs)("div",{className:"pixel-card pixel-card-success",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,s.jsx)(M,{size:20,color:"var(--accent-green)"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-[var(--accent-green)] font-mono uppercase",children:"Position Details"})]}),(0,s.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,s.jsx)(Y,{fullContext:t.finalSuggestion||"",children:(0,s.jsx)(Q.oz,{remarkPlugins:[W.A],components:_,children:e.positionDetails})})})]})]})})()}),"4h"===l&&t.analysis4h&&(0,s.jsxs)("div",{className:"pixel-card",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,s.jsx)(S,{size:20,color:"var(--accent-blue)"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-[var(--accent-blue)] font-mono uppercase",children:"4H Timeframe Analysis"})]}),(0,s.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,s.jsx)(Y,{fullContext:"4H Analysis: ".concat(t.analysis4h||""),children:(0,s.jsx)(Q.oz,{remarkPlugins:[W.A],components:_,children:t.analysis4h})})})]}),"1h"===l&&t.analysis1h&&(0,s.jsxs)("div",{className:"pixel-card",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,s.jsx)(S,{size:20,color:"var(--accent-blue)"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-[var(--accent-blue)] font-mono uppercase",children:"1H Timeframe Analysis"})]}),(0,s.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,s.jsx)(Y,{fullContext:"1H Analysis: ".concat(t.analysis1h||""),children:(0,s.jsx)(Q.oz,{remarkPlugins:[W.A],components:_,children:t.analysis1h})})})]}),"15min"===l&&t.analysis15m&&(0,s.jsxs)("div",{className:"pixel-card",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,s.jsx)(S,{size:20,color:"var(--accent-blue)"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-[var(--accent-blue)] font-mono uppercase",children:"15M Timeframe Analysis"})]}),(0,s.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,s.jsx)(Y,{fullContext:"15M Analysis: ".concat(t.analysis15m||""),children:(0,s.jsx)(Q.oz,{remarkPlugins:[W.A],components:_,children:t.analysis15m})})})]}),"5min"===l&&t.analysis5m&&(0,s.jsxs)("div",{className:"pixel-card",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,s.jsx)(S,{size:20,color:"var(--accent-blue)"}),(0,s.jsx)("h4",{className:"text-lg font-bold text-[var(--accent-blue)] font-mono uppercase",children:"5M Timeframe Analysis"})]}),(0,s.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,s.jsx)(Y,{fullContext:"5M Analysis: ".concat(t.analysis5m||""),children:(0,s.jsx)(Q.oz,{remarkPlugins:[W.A],components:_,children:t.analysis5m})})})]})]})]}):(0,s.jsxs)("div",{className:"pixel-card text-center py-12",children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)(R,{size:64,color:"var(--text-muted)"})}),(0,s.jsx)("h3",{className:"text-lg font-bold text-[var(--text-muted)] font-mono uppercase mb-2",children:"No Analysis Yet"}),(0,s.jsx)("p",{className:"text-[var(--text-secondary)] font-mono",children:"Upload your trading charts to get started"})]})};function X(e){let{selectedText:t,isVisible:r,onSubmit:l,onClose:c}=e,[o,d]=(0,a.useState)(""),h=(0,a.useRef)(null);return(0,a.useEffect)(()=>{r&&h.current&&setTimeout(()=>{var e;return null==(e=h.current)?void 0:e.focus()},100)},[r]),(0,s.jsx)(n.N,{children:r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.P.div,{className:"fixed inset-0 bg-black bg-opacity-20 backdrop-blur-sm z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:c}),(0,s.jsx)(i.P.div,{className:"fixed bottom-0 left-0 right-0 z-50 bottom-query-bar",initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},transition:{type:"spring",damping:25,stiffness:300,duration:.3},children:(0,s.jsx)("div",{className:"w-full max-w-2xl mx-auto px-4 pb-4",children:(0,s.jsxs)("div",{className:"bg-[var(--bg-secondary)] border-2 border-[var(--accent-blue)] rounded-xl shadow-2xl backdrop-filter backdrop-blur-20 contextual-query-popup",children:[(0,s.jsx)("div",{className:"px-4 py-3 border-b border-[var(--border-primary)] bg-[var(--bg-tertiary)] rounded-t-xl",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[(0,s.jsx)(U,{size:18,color:"var(--accent-blue)"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-xs font-mono text-[var(--text-muted)] mb-1",children:"SELECTED TEXT:"}),(0,s.jsxs)("p",{className:"text-sm text-[var(--text-secondary)] italic truncate",children:['"',t,'"']})]})]}),(0,s.jsx)("button",{onClick:c,className:"p-1 hover:bg-[var(--bg-primary)] rounded transition-colors ml-2 flex-shrink-0","aria-label":"Close",children:(0,s.jsx)(A,{size:16})})]})}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o.trim()&&(l(o.trim()),d(""))},className:"p-4",children:[(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("input",{ref:h,type:"text",value:o,onChange:e=>d(e.target.value),placeholder:"Ask a question about this selection...",className:"flex-1 px-4 py-3 bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-lg font-mono text-sm text-[var(--text-primary)] placeholder-[var(--text-muted)] focus:outline-none focus:border-[var(--accent-blue)] focus:ring-2 focus:ring-[var(--accent-blue)] focus:ring-opacity-20 transition-all",onKeyDown:e=>{"Escape"===e.key&&c()}}),(0,s.jsxs)(i.P.button,{type:"submit",disabled:!o.trim(),className:"px-6 py-3 bg-[var(--accent-blue)] text-[var(--bg-primary)] rounded-lg font-mono text-sm font-bold disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center space-x-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,s.jsx)(F,{size:16}),(0,s.jsx)("span",{children:"Ask"})]})]}),(0,s.jsx)("p",{className:"text-xs text-[var(--text-muted)] mt-2 text-center font-mono",children:"Press Enter to ask • Escape to close"})]})]})})})]})})}function J(e){let{isOpen:t,initialQuestion:r,selectedText:l,fullContext:c,onClose:o}=e,[d,h]=(0,a.useState)([]),[x,m]=(0,a.useState)(""),[u,p]=(0,a.useState)(!1),[g,y]=(0,a.useState)(""),j=(0,a.useRef)(null),v=(0,a.useRef)(null);(0,a.useEffect)(()=>{var e;null==(e=j.current)||e.scrollIntoView({behavior:"smooth"})},[d]),(0,a.useEffect)(()=>{t&&r&&0===d.length&&b(r,!0)},[t,r]),(0,a.useEffect)(()=>{t&&v.current&&setTimeout(()=>{var e;return null==(e=v.current)?void 0:e.focus()},300)},[t]);let b=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.trim()||u)return;let r={id:Date.now().toString(),type:"user",content:e,timestamp:new Date,selectedText:t?l:void 0};h(e=>[...e,r]),m(""),p(!0),y("");try{let t=await f({question:e.trim(),selectedText:l,fullContext:c}),r={id:(Date.now()+1).toString(),type:"assistant",content:t,timestamp:new Date};h(e=>[...e,r])}catch(t){y(t instanceof Error?t.message:"Failed to get answer");let e={id:(Date.now()+1).toString(),type:"assistant",content:"Sorry, I encountered an error: ".concat(t instanceof Error?t.message:"Unknown error"),timestamp:new Date};h(t=>[...t,e])}finally{p(!1)}};return(0,s.jsx)(n.N,{children:t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.P.div,{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-40 lg:hidden",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:o}),(0,s.jsxs)(i.P.div,{className:"fixed right-0 top-0 h-full w-full lg:w-96 bg-[var(--bg-secondary)] border-l-2 border-[var(--accent-blue)] z-50 flex flex-col shadow-2xl chat-sidebar",initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:300,duration:.4},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-[var(--border-primary)] bg-[var(--bg-tertiary)]",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(U,{size:20,color:"var(--accent-blue)"}),(0,s.jsx)("h3",{className:"font-mono font-bold text-sm uppercase text-[var(--text-primary)]",children:"Contextual Chat"})]}),(0,s.jsx)("button",{onClick:o,className:"p-2 hover:bg-[var(--bg-primary)] rounded transition-colors","aria-label":"Close chat",children:(0,s.jsx)(A,{size:18})})]}),(0,s.jsxs)("div",{className:"p-3 bg-[var(--bg-primary)] border-b border-[var(--border-primary)]",children:[(0,s.jsx)("p",{className:"text-xs font-mono text-[var(--text-muted)] mb-1",children:"DISCUSSING:"}),(0,s.jsxs)("p",{className:"text-sm text-[var(--text-secondary)] italic line-clamp-3",children:['"',l,'"']})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[d.map(e=>(0,s.jsx)(i.P.div,{className:"flex ".concat("user"===e.type?"justify-end":"justify-start"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,s.jsxs)("div",{className:"max-w-[80%] p-3 rounded-lg font-mono text-sm ".concat("user"===e.type?"bg-[var(--accent-blue)] text-[var(--bg-primary)] rounded-br-none":"bg-[var(--bg-tertiary)] text-[var(--text-primary)] border border-[var(--border-primary)] rounded-bl-none"),children:[e.selectedText&&(0,s.jsxs)("div",{className:"mb-2 p-2 bg-black bg-opacity-20 rounded text-xs italic",children:['Re: "',e.selectedText.substring(0,50),'..."']}),(0,s.jsx)("div",{className:"whitespace-pre-wrap",children:e.content}),(0,s.jsx)("div",{className:"text-xs mt-2 opacity-70 ".concat("user"===e.type?"text-right":"text-left"),children:e.timestamp.toLocaleTimeString()})]})},e.id)),u&&(0,s.jsx)(i.P.div,{className:"flex justify-start",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,s.jsxs)("div",{className:"bg-[var(--bg-tertiary)] border border-[var(--border-primary)] p-3 rounded-lg rounded-bl-none flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"pixel-loader w-4 h-4"}),(0,s.jsx)("span",{className:"text-sm font-mono text-[var(--text-muted)]",children:"Analyzing..."})]})}),(0,s.jsx)("div",{ref:j})]}),(0,s.jsx)("div",{className:"p-4 border-t border-[var(--border-primary)] bg-[var(--bg-tertiary)]",children:(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b(x)},className:"flex space-x-2",children:[(0,s.jsx)("input",{ref:v,type:"text",value:x,onChange:e=>m(e.target.value),placeholder:"Ask a follow-up question...",className:"flex-1 px-3 py-2 bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded font-mono text-sm text-[var(--text-primary)] placeholder-[var(--text-muted)] focus:outline-none focus:border-[var(--accent-blue)] transition-colors",disabled:u,onKeyDown:e=>{"Escape"===e.key&&o()}}),(0,s.jsx)(i.P.button,{type:"submit",disabled:!x.trim()||u,className:"px-4 py-2 bg-[var(--accent-blue)] text-[var(--bg-primary)] rounded font-mono text-sm font-bold disabled:opacity-50 disabled:cursor-not-allowed transition-all",whileHover:{scale:1.05},whileTap:{scale:.95},children:u?(0,s.jsx)(I,{size:16}):(0,s.jsx)(F,{size:16})})]})})]})]})})}function Z(){let{state:e,hideQueryBar:t,showChatSidebar:r,hideChatSidebar:a,clearSelection:i}=G();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X,{selectedText:e.selectedText,isVisible:e.showQueryBar,onSubmit:e=>{r(e)},onClose:()=>{t(),i()}}),(0,s.jsx)(J,{isOpen:e.showChatSidebar,initialQuestion:e.initialQuestion,selectedText:e.selectedText,fullContext:e.fullContext,onClose:()=>{a(),i()}})]})}function $(){let[e,t]=(0,a.useState)({chart4h:null,chart1h:null,chart15m:null,chart5m:null}),[r,l]=(0,a.useState)([]),[c,o]=(0,a.useState)(!1),[d,h]=(0,a.useState)({}),[x,m]=(0,a.useState)(!1),[u,p]=(0,a.useState)(null),[g,f]=(0,a.useState)(null),[j,v]=(0,a.useState)(0),[b,w]=(0,a.useState)(!1),N=async r=>{o(!0);let s={"4h":"chart4h","4H":"chart4h","1h":"chart1h","1H":"chart1h","15m":"chart15m","15min":"chart15m","5m":"chart5m","5min":"chart5m"},a=[...r],i={...e};for(let e=0;e<a.length;e++)if(!a[e].detectedTimeframe)try{let t=await y({image:a[e].file,prompt:"\nThis is a TradingView chart screenshot. Identify the currently selected timeframe.\n\nIn TradingView, the selected timeframe appears as a highlighted button in the top toolbar.\nIt will be one of these options: 4h, 1h, 15m, or 5m (may appear as 5).\n\nThe selected timeframe button typically:\n- Has a different background color than other timeframe buttons\n- May be darker or lighter than surrounding buttons\n- May have a border or glow effect\n- Is positioned in the timeframe selector area of the toolbar\n\nPay special attention to the 5m timeframe, which may appear simply as '5' in the interface.\n\nRespond with ONLY one of these exact timeframes:\n- 4h (for 4 hour charts)\n- 1h (for 1 hour charts) \n- 15m (for 15 minute charts)\n- 5m (for 5 minute charts)\n\nIf you cannot clearly identify the selected timeframe, respond with \"unknown\".\n"}),r=s[t.trim().toLowerCase()];r?(a[e].detectedTimeframe=r,i[r]=a[e].file):a[e].error="Could not detect timeframe: ".concat(t)}catch(t){console.error("Error detecting timeframe:",t),a[e].error="Failed to detect timeframe"}l(a),t(i),o(!1)},C=async()=>{if(!r.some(e=>e.detectedTimeframe))return void p("Please upload at least one chart with a detected timeframe.");m(!0),p(null),h({}),v(0);let t={chart4h:"\nYou are an expert trading analyst. Analyze this 4-hour chart and provide detailed technical analysis.\n\nFocus on:\n1. **Trend Analysis**: Current trend direction and strength\n2. **Support/Resistance**: Key levels and price action around them\n3. **Technical Indicators**: RSI, moving averages, volume, any visible indicators\n4. **Chart Patterns**: Any recognizable patterns (triangles, flags, head & shoulders, etc.)\n5. **Market Structure**: Higher highs/lows, market phases\n6. **Risk Assessment**: Potential risks and invalidation levels\n\nProvide your analysis in a structured format with clear sections. Be specific about price levels when visible.\n",chart1h:"\nYou are an expert trading analyst. Analyze this 1-hour chart and provide detailed technical analysis.\n\nFocus on:\n1. **Short-term Trend**: Current momentum and direction\n2. **Entry/Exit Zones**: Potential trade entry and exit points\n3. **Support/Resistance**: Immediate key levels\n4. **Technical Indicators**: RSI, moving averages, volume patterns\n5. **Price Action**: Recent candlestick patterns and market behavior\n6. **Confluence**: Areas where multiple factors align\n\nProvide actionable insights for short-term trading decisions. Be specific about timing and levels.\n",chart15m:"\nYou are an expert trading analyst. Analyze this 15-minute chart for precise entry timing.\n\nFocus on:\n1. **Micro Trends**: Very short-term price movements\n2. **Entry Timing**: Precise entry signals and confirmations\n3. **Scalping Opportunities**: Quick profit-taking levels\n4. **Volume Analysis**: Volume spikes and patterns\n5. **Price Action**: Recent candle formations and momentum\n6. **Risk Management**: Stop-loss placement for short-term trades\n\nProvide specific timing guidance for intraday trading strategies.\n",chart5m:"\nYou are an expert trading analyst. Analyze this 5-minute chart for scalping and precise timing.\n\nFocus on:\n1. **Immediate Price Action**: Current momentum and micro-movements\n2. **Scalping Setups**: Quick entry/exit opportunities\n3. **Volume Confirmation**: Volume supporting price moves\n4. **Support/Resistance**: Immediate levels for quick trades\n5. **Market Noise**: Filtering out false signals\n6. **Execution Timing**: Optimal entry and exit timing\n\nProvide ultra-short-term trading insights with specific timing recommendations.\n"},s=["chart4h","chart1h","chart15m","chart5m"],a={chart4h:"4h",chart1h:"1h",chart15m:"15min",chart5m:"5min"},i={},n=0,l=s.filter(t=>e[t]).length+1;try{for(let r of s)if(e[r]){f(a[r]);let s=await y({image:e[r],prompt:t[r]}),c="analysis".concat(r.replace("chart",""));i[c]=s,h(e=>({...e,[c]:s})),n++,v(n/l*100)}f("final");let r=Object.entries(i).filter(e=>{let[t,r]=e;return r}).map(e=>{let[t,r]=e;return"## ".concat(t.replace("analysis","").toUpperCase()," Analysis:\n").concat(r)}).join("\n\n"),c=await y({image:e.chart4h||e.chart1h||e.chart15m||e.chart5m,prompt:"\nYou are an expert trading analyst. Based on the multi-timeframe analysis provided below, create a comprehensive trading recommendation.\n\n".concat(r,"\n\n## Instructions:\nProvide a structured final recommendation with these sections:\n\n### Trading Summary\n- **Overall Market Bias**: Bullish/Bearish/Neutral with confidence level\n- **Recommended Action**: BUY/SELL/WAIT with clear reasoning\n- **Trade Type**: Swing/Intraday/Scalp based on the setup quality\n- **Confidence Level**: High/Medium/Low\n\n### Reasoning\n- **Multi-timeframe Confluence**: How different timeframes align\n- **Key Technical Factors**: Most important signals supporting the decision\n- **Risk Factors**: What could invalidate this analysis\n- **Market Context**: Current market conditions and their impact\n\n### Position Details\n- **Entry Zone**: Specific price levels for entry\n- **Stop Loss**: Exact stop-loss levels with reasoning\n- **Take Profit**: Multiple TP levels with percentages\n- **Position Size**: Recommended risk percentage\n- **Time Horizon**: Expected trade duration\n- **Alternative Scenarios**: What to do if price moves differently\n\n### Waiting Points\n- If the recommendation is WAIT, specify:\n  - What levels to watch for entry\n  - What confirmations to wait for\n  - Alternative shorter-term opportunities\n  - When to reassess the situation\n\nBe specific with price levels, percentages, and actionable guidance. Focus on practical trading decisions.\n")});i.finalSuggestion=c,h(e=>({...e,finalSuggestion:c})),v(100),f(null)}catch(e){console.error("Analysis error:",e),p(e instanceof Error?e.message:"An error occurred during analysis")}finally{m(!1)}};return(0,s.jsxs)(V,{children:[(0,s.jsxs)(i.P.div,{className:"min-h-screen bg-[var(--bg-primary)] text-[var(--text-primary)]",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,s.jsx)(i.P.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,delay:.1},children:(0,s.jsx)(O,{})}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(H,{isOpen:b,onToggle:()=>w(!b),uploadedImages:r,progress:j,currentStep:g,onClearImages:()=>{l([]),t({chart4h:null,chart1h:null,chart15m:null,chart5m:null}),h({}),p(null),v(0),f(null)}}),(0,s.jsxs)(i.P.main,{className:"flex-1 lg:ml-0 p-6",initial:{x:50,opacity:0},animate:{x:0,opacity:1},transition:{duration:.7,delay:.2},children:[(0,s.jsx)(i.P.button,{onClick:()=>w(!0),className:"lg:hidden pixel-btn mb-4 w-12 h-12 p-0 flex items-center justify-center","aria-label":"Open sidebar",whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,s.jsx)(T,{size:24})}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,s.jsxs)(i.P.section,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,delay:.3},children:[(0,s.jsxs)(i.P.div,{className:"flex items-center space-x-3 mb-4 border-b-2 border-[var(--accent-blue)] pb-2",initial:{x:-30,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5,delay:.4},children:[(0,s.jsx)(i.P.div,{className:"floating",animate:{y:[0,-5,0],rotate:[0,5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:(0,s.jsx)(S,{size:28,color:"var(--accent-blue)"})}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-[var(--text-primary)] font-mono uppercase gradient-text",children:"Chart Analysis"})]}),(0,s.jsx)(i.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.5},children:(0,s.jsx)(L,{onFilesSelected:e=>{let t=e.map(e=>({file:e}));l(e=>[...e,...t]),N([...r,...t])},uploadedImages:r,isAnalyzing:x||c})}),(0,s.jsx)(n.N,{children:r.length>0&&!x&&(0,s.jsx)(i.P.div,{className:"mt-6 text-center",initial:{y:20,opacity:0,scale:.8},animate:{y:0,opacity:1,scale:1},exit:{y:-20,opacity:0,scale:.8},transition:{duration:.4},children:(0,s.jsx)(i.P.button,{onClick:C,className:"pixel-btn pixel-btn-primary text-lg px-8 py-4",disabled:!r.some(e=>e.detectedTimeframe),whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},animate:{boxShadow:["0 0 20px rgba(0, 128, 255, 0.3)","0 0 30px rgba(0, 128, 255, 0.5)","0 0 20px rgba(0, 128, 255, 0.3)"]},transition:{boxShadow:{duration:2,repeat:1/0,ease:"easeInOut"}},children:"Start Analysis"})})})]}),(0,s.jsxs)(i.P.section,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,delay:.6},children:[(0,s.jsxs)(i.P.div,{className:"flex items-center space-x-3 mb-4 border-b-2 border-[var(--accent-green)] pb-2",initial:{x:-30,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5,delay:.7},children:[(0,s.jsx)(i.P.div,{animate:{scale:[1,1.1,1],rotate:[0,10,0]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:(0,s.jsx)(k,{size:28,color:"var(--accent-green)"})}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-[var(--text-primary)] font-mono uppercase gradient-text",children:"Analysis Results"})]}),(0,s.jsx)(i.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.8},children:(0,s.jsx)(K,{results:d,loading:x,error:u,currentStep:g})})]})]})]})]}),(0,s.jsx)(i.P.footer,{className:"border-t-2 border-[var(--border-primary)] bg-[var(--bg-secondary)] p-4",initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,delay:.9},children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between text-sm font-mono",children:[(0,s.jsx)(i.P.div,{className:"text-[var(--text-muted)]",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5,delay:1},children:"Trading Guide v2.0 • Powered by Gemini Vision AI"}),(0,s.jsx)(i.P.div,{className:"text-[var(--text-muted)]",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{duration:.5,delay:1.1},children:"Always trade responsibly • Not financial advice"})]})})]}),(0,s.jsx)(Z,{})]})}},7740:(e,t,r)=>{"use strict";r.d(t,{D:()=>n,ThemeProvider:()=>l});var s=r(5155),a=r(2115);let i=(0,a.createContext)(void 0),n=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e},l=e=>{let{children:t}=e,[r,n]=(0,a.useState)("dark"),[l,c]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{let e=localStorage.getItem("trading-guide-theme");e&&("dark"===e||"light"===e)?n(e):n(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),c(!0)},[]),(0,a.useEffect)(()=>{l&&(document.documentElement.setAttribute("data-theme",r),localStorage.setItem("trading-guide-theme",r))},[r,l]),l)?(0,s.jsx)(i.Provider,{value:{theme:r,toggleTheme:()=>{n(e=>"dark"===e?"light":"dark")},setTheme:e=>{n(e)}},children:t}):null}},9557:(e,t,r)=>{Promise.resolve().then(r.bind(r,4421))}},e=>{e.O(0,[118,441,964,358],()=>e(e.s=9557)),_N_E=e.O()}]);